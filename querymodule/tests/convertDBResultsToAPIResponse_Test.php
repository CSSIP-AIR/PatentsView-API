<?php
/**
 * Created by PhpStorm.
 * User=>gregy
 * Date=>9/25/2014
 * Time=>11:30 AM
 */

require_once dirname(__FILE__) . '/../app/convertDBResultsToNestedStructure.php';

class convertDBResultsToAPIResponse_Test extends PHPUnit_Framework_TestCase
{
    public function testConversion()
    {
        $dbResults = array(array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Watterodt', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-1', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Watterodt', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-1', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Gillick', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-10', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Gillick', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-10', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Papp', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-11', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Papp', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-11', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Park', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-2', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Park', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-2', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Rego', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-3', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Rego', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-3', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Andreacchi', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-4', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Andreacchi', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-4', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Chen', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-5', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Chen', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-5', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Currlin', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-6', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Currlin', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-6', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Garcia', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-7', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Garcia', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-7', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Sciver', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-8', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Sciver', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-8', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Glenn', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-9', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventor_last_name' => 'Glenn', 'patent_title' => 'Methods and devices for drying coated stents', 'assignee_last_name' => '', 'patent_id' => '8677650', 'inventor_id' => '8677650-9', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677690', 'inventor_last_name' => 'Lee', 'patent_title' => 'Fuel door opening/closing apparatus for vehicle', 'assignee_last_name' => '', 'patent_id' => '8677690', 'inventor_id' => '8677690-1', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677690', 'inventor_last_name' => 'Lee', 'patent_title' => 'Fuel door opening/closing apparatus for vehicle', 'assignee_last_name' => '', 'patent_id' => '8677690', 'inventor_id' => '8677690-1', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677690', 'inventor_last_name' => 'Kim', 'patent_title' => 'Fuel door opening/closing apparatus for vehicle', 'assignee_last_name' => '', 'patent_id' => '8677690', 'inventor_id' => '8677690-2', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677690', 'inventor_last_name' => 'Kim', 'patent_title' => 'Fuel door opening/closing apparatus for vehicle', 'assignee_last_name' => '', 'patent_id' => '8677690', 'inventor_id' => '8677690-2', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677690', 'inventor_last_name' => 'Oh', 'patent_title' => 'Fuel door opening/closing apparatus for vehicle', 'assignee_last_name' => '', 'patent_id' => '8677690', 'inventor_id' => '8677690-3', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677690', 'inventor_last_name' => 'Oh', 'patent_title' => 'Fuel door opening/closing apparatus for vehicle', 'assignee_last_name' => '', 'patent_id' => '8677690', 'inventor_id' => '8677690-3', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Lee', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-1', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Lee', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-1', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Lee', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-1', 'assignee_id' => 'e24d52962caf94a7cc05a85a6741251d'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Park', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-2', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Park', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-2', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Park', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-2', 'assignee_id' => 'e24d52962caf94a7cc05a85a6741251d'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Severin', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-3', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Severin', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-3', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Severin', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-3', 'assignee_id' => 'e24d52962caf94a7cc05a85a6741251d'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Wittka', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-4', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Wittka', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-4', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventor_last_name' => 'Wittka', 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'assignee_last_name' => '', 'patent_id' => '8677740', 'inventor_id' => '8677740-4', 'assignee_id' => 'e24d52962caf94a7cc05a85a6741251d'));
        $results = convertDBResultsToNestedStructure($dbResults);
        $expected = array('count' => 3, 'patents' => array(array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677650', 'inventors' => array(array('inventor_last_name' => 'Watterodt', 'inventor_id' => '8677650-1'), array('inventor_last_name' => 'Gillick', 'inventor_id' => '8677650-10'), array('inventor_last_name' => 'Papp', 'inventor_id' => '8677650-11'), array('inventor_last_name' => 'Park', 'inventor_id' => '8677650-2'), array('inventor_last_name' => 'Rego', 'inventor_id' => '8677650-3'), array('inventor_last_name' => 'Andreacchi', 'inventor_id' => '8677650-4'), array('inventor_last_name' => 'Chen', 'inventor_id' => '8677650-5'), array('inventor_last_name' => 'Currlin', 'inventor_id' => '8677650-6'), array('inventor_last_name' => 'Garcia', 'inventor_id' => '8677650-7'), array('inventor_last_name' => 'Sciver', 'inventor_id' => '8677650-8'), array('inventor_last_name' => 'Glenn', 'inventor_id' => '8677650-9')), 'patent_title' => 'Methods and devices for drying coated stents', 'patent_id' => '8677650', 'assignees' => array(array('assignee_last_name' => '', 'assignee_id' => '3429326e7bb965b6108a4a2e6c61c426'), array('assignee_last_name' => '', 'assignee_id' => 'afd04c6baba838ae9578fa8092e2eeec'))), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677690', 'inventors' => array(array('inventor_last_name' => 'Lee', 'inventor_id' => '8677690-1'), array('inventor_last_name' => 'Kim', 'inventor_id' => '8677690-2'), array('inventor_last_name' => 'Oh', 'inventor_id' => '8677690-3')), 'patent_title' => 'Fuel door opening/closing apparatus for vehicle', 'patent_id' => '8677690', 'assignees' => array(array('assignee_last_name' => '', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('assignee_last_name' => '', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'))), array('patent_country' => 'US', 'patent_type' => 'utility', 'patent_number' => '8677740', 'inventors' => array(array('inventor_last_name' => 'Lee', 'inventor_id' => '8677740-1'), array('inventor_last_name' => 'Park', 'inventor_id' => '8677740-2'), array('inventor_last_name' => 'Severin', 'inventor_id' => '8677740-3'), array('inventor_last_name' => 'Wittka', 'inventor_id' => '8677740-4')), 'patent_title' => 'Method for predicting regeneration of DeNOx catalyst and exhaust system using the same', 'patent_id' => '8677740', 'assignees' => array(array('assignee_last_name' => '', 'assignee_id' => '6940c2025c37e80b9ad46852399a97f9'), array('assignee_last_name' => '', 'assignee_id' => 'e04f205b05e4a7ea46d3096867c3dd5b'), array('assignee_last_name' => '', 'assignee_id' => 'e24d52962caf94a7cc05a85a6741251d')))));
        $this->assertEquals($expected, $results);
    }
}
 